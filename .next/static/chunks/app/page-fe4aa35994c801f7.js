(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5115:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>u});var n=a(5155),l=a(2115);function t(e){let{combo:s,onClick:a,onCardHover:l,onCardLeave:t}=e;return(0,n.jsxs)("div",{className:"combo-card",onClick:a,children:[(0,n.jsx)("h3",{children:s.uses.map(e=>e.card.name).join(" + ")||"Unnamed Combo"}),(0,n.jsx)("div",{className:"combo-cards-list",children:s.uses.map((e,s)=>(0,n.jsxs)("div",{children:["• ",(0,n.jsx)("span",{className:"card-name-hover",onMouseEnter:s=>((e,s)=>{e.stopPropagation();let a=e.currentTarget.getBoundingClientRect();l(s,a.right,a.top)})(s,e.card.name),onMouseLeave:t,children:e.card.name}),e.quantity>1&&" (x".concat(e.quantity,")")]},s))}),(0,n.jsxs)("div",{className:"combo-tags",children:[s.manaNeeded&&(0,n.jsx)("span",{className:"tag mana-tag",children:function(e){if(!e)return null;let s=[],a=0;for(;a<e.length;)if("{"===e[a]){let l=e.indexOf("}",a);if(-1!==l){let t=e.substring(a+1,l).toLowerCase();s.push((0,n.jsx)("i",{className:"ms ms-".concat(t," ms-cost")},a)),a=l+1}else a++}else{let l=e[a];l.match(/[WUBRGC]/i)?s.push((0,n.jsx)("i",{className:"ms ms-".concat(l.toLowerCase()," ms-cost")},a)):l.match(/\d/)&&s.push((0,n.jsx)("i",{className:"ms ms-".concat(l," ms-cost")},a)),a++}return(0,n.jsx)(n.Fragment,{children:s})}(s.manaNeeded)}),(0,n.jsxs)("span",{className:"tag color-identity-tag",children:[s.identity.split("").map((e,s)=>(0,n.jsx)("i",{className:"ms ms-".concat(e.toLowerCase()," ms-cost")},s)),""===s.identity&&(0,n.jsx)("i",{className:"ms ms-c ms-cost"})]})]}),(0,n.jsx)("p",{className:"combo-description",children:s.produces.length>0?s.produces[0].feature.name:"Various effects"})]})}function r(e){let{cardName:s,position:a}=e,[t,r]=(0,l.useState)(null),[c,i]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{i(!0),r(null);let e=setTimeout(()=>{fetch("https://api.scryfall.com/cards/named?exact=".concat(encodeURIComponent(s))).then(e=>e.json()).then(e=>{var s,a,n,l;r((null==(s=e.image_uris)?void 0:s.normal)||(null==(l=e.card_faces)||null==(n=l[0])||null==(a=n.image_uris)?void 0:a.normal)),i(!1)}).catch(()=>{i(!1)})},300);return()=>clearTimeout(e)},[s]),c||!t)return null;let o=a.x>window.innerWidth/2?a.x-260:a.x+20,d=a.y>window.innerHeight/2?a.y-360:a.y;return(0,n.jsx)("div",{className:"card-preview",style:{left:"".concat(o,"px"),top:"".concat(d,"px")},children:(0,n.jsx)("img",{src:t,alt:s})})}function c(e){let{combo:s,onClose:a}=e,[t,c]=(0,l.useState)(null),i=()=>{c(null)};return(0,n.jsxs)("div",{className:"modal-overlay",onClick:a,children:[(0,n.jsxs)("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"modal-header",children:[(0,n.jsx)("h2",{children:s.uses.map(e=>e.card.name).join(" + ")||"Unnamed Combo"}),(0,n.jsx)("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),(0,n.jsxs)("div",{className:"modal-body",children:[(0,n.jsx)("div",{className:"card-images",children:s.uses.map(e=>e.card.imageUriFrontNormal&&(0,n.jsx)("img",{src:e.card.imageUriFrontNormal,alt:e.card.name,className:"card-image"},e.card.id))}),(0,n.jsxs)("div",{className:"combo-info",children:[(0,n.jsx)("h3",{children:"Cards Required"}),s.uses.map((e,s)=>(0,n.jsxs)("p",{children:["• ",(0,n.jsx)("span",{className:"card-name-hover",onMouseEnter:s=>((e,s)=>{let a=e.currentTarget.getBoundingClientRect();c({name:s,x:a.right,y:a.top})})(s,e.card.name),onMouseLeave:i,children:e.card.name}),e.quantity>1&&" (x".concat(e.quantity,")")]},s)),(0,n.jsx)("h3",{children:"Required Mana"}),(0,n.jsx)("p",{children:function(e){if(!e)return(0,n.jsx)("span",{style:{color:"#9ca3af"},children:"Variable"});let s=[],a=0;for(;a<e.length;)if("{"===e[a]){let l=e.indexOf("}",a);if(-1!==l){let t=e.substring(a+1,l).toLowerCase();s.push((0,n.jsx)("i",{className:"ms ms-".concat(t," ms-cost ms-2x")},a)),a=l+1}else a++}else{let l=e[a];l.match(/[WUBRGC]/i)?s.push((0,n.jsx)("i",{className:"ms ms-".concat(l.toLowerCase()," ms-cost ms-2x")},a)):l.match(/\d/)&&s.push((0,n.jsx)("i",{className:"ms ms-".concat(l," ms-cost ms-2x")},a)),a++}return(0,n.jsx)("span",{style:{display:"flex",gap:"0.25rem",alignItems:"center"},children:s})}(s.manaNeeded)}),(0,n.jsx)("h3",{children:"Color Identity"}),(0,n.jsx)("p",{style:{display:"flex",gap:"0.35rem",alignItems:"center"},children:s.identity?s.identity.split("").map((e,s)=>(0,n.jsx)("i",{className:"ms ms-".concat(e.toLowerCase()," ms-cost ms-2x")},s)):(0,n.jsx)("i",{className:"ms ms-c ms-cost ms-2x"})}),(0,n.jsx)("h3",{children:"Legal Formats"}),(0,n.jsx)("p",{children:(()=>{let e=[];return s.legalities.commander&&e.push("Commander"),s.legalities.modern&&e.push("Modern"),s.legalities.legacy&&e.push("Legacy"),s.legalities.vintage&&e.push("Vintage"),s.legalities.standard&&e.push("Standard"),s.legalities.pioneer&&e.push("Pioneer"),s.legalities.brawl&&e.push("Brawl"),s.legalities.oathbreaker&&e.push("Oathbreaker"),e.length>0?e.join(", "):"None"})()}),(0,n.jsx)("h3",{children:"How it Works"}),(0,n.jsx)("ol",{children:s.description.split("\n").filter(e=>e.trim()).map((e,s)=>(0,n.jsx)("li",{children:e},s))}),(0,n.jsx)("h3",{children:"Results"}),(0,n.jsx)("div",{className:"result",children:s.produces.map((e,s)=>(0,n.jsx)("div",{children:(0,n.jsxs)("strong",{children:["• ",e.feature.name]})},s))}),s.popularity&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{children:"Popularity"}),(0,n.jsxs)("p",{children:[s.popularity.toLocaleString()," decks"]})]})]})]})]}),t&&(0,n.jsx)(r,{cardName:t.name,position:{x:t.x,y:t.y}})]})}let i=["W","U","B","R","G","C"],o=["Commander","Modern","Legacy","Standard","Pioneer","Vintage"];function d(e){let{selectedColors:s,selectedFormats:a,onColorToggle:t,onFormatToggle:r}=e,[c,d]=(0,l.useState)(!1);return(0,n.jsxs)("div",{className:"filter-panel",children:[(0,n.jsx)("button",{className:"filter-toggle",onClick:()=>d(!c),children:c?"Hide Filters":"Show Filters"}),(0,n.jsxs)("div",{className:"filter-content ".concat(c?"open":""),children:[(0,n.jsxs)("div",{className:"filter-section",children:[(0,n.jsx)("h3",{children:"Color Identity"}),(0,n.jsx)("div",{className:"color-filters",children:i.map(e=>(0,n.jsx)("button",{className:"color-btn ".concat(s.includes(e)?"active":""),onClick:()=>t(e),title:{W:"White",U:"Blue",B:"Black",R:"Red",G:"Green",C:"Colorless"}[e],children:(0,n.jsx)("i",{className:"ms ms-".concat({W:"w",U:"u",B:"b",R:"r",G:"g",C:"c"}[e]," ms-2x ms-cost")})},e))})]}),(0,n.jsxs)("div",{className:"filter-section",children:[(0,n.jsx)("h3",{children:"Formats"}),(0,n.jsx)("div",{className:"format-filters",children:o.map(e=>(0,n.jsxs)("label",{className:"format-checkbox",children:[(0,n.jsx)("input",{type:"checkbox",checked:a.includes(e),onChange:()=>r(e)}),e]},e))})]})]})]})}function m(e){let{onImport:s,onClear:a,hasDecklist:t,deckName:r,comboCount:c}=e,[i,o]=(0,l.useState)(""),[d,m]=(0,l.useState)(!t),h=()=>{o(""),a(),m(!0)};return!d&&t?(0,n.jsx)("div",{className:"decklist-banner",children:(0,n.jsxs)("div",{className:"decklist-banner-content",children:[(0,n.jsx)("span",{className:"banner-icon",children:"✓"}),(0,n.jsxs)("div",{className:"banner-info",children:[(0,n.jsx)("strong",{children:r||"Decklist loaded"}),void 0!==c&&(0,n.jsxs)("span",{className:"combo-count",children:[c," combo",1!==c?"s":""," found"]})]}),(0,n.jsxs)("div",{className:"decklist-banner-actions",children:[(0,n.jsx)("button",{onClick:()=>{o(""),m(!0)},className:"btn-secondary-small",children:"Import Different Deck"}),(0,n.jsx)("button",{onClick:h,className:"btn-secondary-small",children:"Browse All Combos"})]})]})}):(0,n.jsxs)("div",{className:"decklist-import",children:[(0,n.jsxs)("div",{className:"import-header",children:[(0,n.jsx)("h2",{children:"\uD83C\uDFB4 Find Combos in Your Deck"}),(0,n.jsx)("p",{children:"Copy your decklist from Moxfield or Archidekt and paste below!"})]}),(0,n.jsxs)("div",{className:"how-to-export",children:[(0,n.jsxs)("div",{className:"export-method",children:[(0,n.jsx)("strong",{children:"From Moxfield:"}),(0,n.jsxs)("ol",{children:[(0,n.jsx)("li",{children:"Open your deck on Moxfield"}),(0,n.jsxs)("li",{children:["Click the ",(0,n.jsx)("strong",{children:"Export"})," button (top right)"]}),(0,n.jsxs)("li",{children:["Choose ",(0,n.jsx)("strong",{children:'"Text"'})," or ",(0,n.jsx)("strong",{children:'"MTGO"'})]}),(0,n.jsxs)("li",{children:["Click ",(0,n.jsx)("strong",{children:"Copy to Clipboard"})]}),(0,n.jsx)("li",{children:"Paste below!"})]})]}),(0,n.jsxs)("div",{className:"export-method",children:[(0,n.jsx)("strong",{children:"From Archidekt:"}),(0,n.jsxs)("ol",{children:[(0,n.jsx)("li",{children:"Open your deck on Archidekt"}),(0,n.jsxs)("li",{children:["Click ",(0,n.jsx)("strong",{children:"Export"})]}),(0,n.jsxs)("li",{children:["Choose ",(0,n.jsx)("strong",{children:'"Text"'})]}),(0,n.jsx)("li",{children:"Copy the text"}),(0,n.jsx)("li",{children:"Paste below!"})]})]})]}),(0,n.jsx)("textarea",{className:"decklist-textarea",value:i,onChange:e=>o(e.target.value),placeholder:"Commander:\nThassa's Oracle\n\nDeck:\n1 Demonic Consultation\n1 Tainted Pact\n1 Sol Ring\n1 Mana Vault\n1 Basalt Monolith\n1 Dramatic Reversal\n1 Isochron Scepter\n1 Exquisite Blood\n1 Sanguine Bond",rows:15}),(0,n.jsxs)("div",{className:"text-help",children:[(0,n.jsx)("h4",{children:"✓ Supports All Formats:"}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:"Moxfield exports (Text or MTGO)"}),(0,n.jsx)("li",{children:"Archidekt exports (Text)"}),(0,n.jsx)("li",{children:"MTGO format (1 Card Name)"}),(0,n.jsx)("li",{children:"Arena format (1 Card Name (SET) 123)"}),(0,n.jsx)("li",{children:"Plain text (one card per line)"}),(0,n.jsx)("li",{children:"Any format with card names!"})]})]}),(0,n.jsxs)("div",{className:"import-actions",children:[(0,n.jsx)("button",{onClick:()=>{i.trim()&&(s(i),m(!1))},className:"btn-primary",disabled:!i.trim(),children:"Find Combos in My Deck"}),t&&(0,n.jsx)("button",{onClick:h,className:"btn-secondary",children:"Browse All Combos Instead"})]})]})}async function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{let a=await fetch("/combos.json");if(a.ok){let n=await a.json();return{...n,results:n.results.slice(s,s+e)}}}catch(e){console.warn("Failed to load local combos cache, falling back to API")}let a=await fetch("".concat("https://backend.commanderspellbook.com","/variants/?limit=").concat(e,"&offset=").concat(s));if(!a.ok)throw Error("Failed to fetch combos");return a.json()}function x(e){return e.toLowerCase().trim().replace(/[^a-z0-9\s]/g,"")}function u(){let[e,s]=(0,l.useState)([]),[a,i]=(0,l.useState)(!0),[o,u]=(0,l.useState)(!1),[p,j]=(0,l.useState)(null),[g,f]=(0,l.useState)(""),[b,N]=(0,l.useState)([]),[C,y]=(0,l.useState)([]),[v,k]=(0,l.useState)(null),[w,S]=(0,l.useState)(null),[F,L]=(0,l.useState)([]),[M,T]=(0,l.useState)(""),[A,B]=(0,l.useState)([]),[R,E]=(0,l.useState)([]);(0,l.useEffect)(()=>{!async function(){try{i(!0);let e=await h(1e3,0);s(e.results),j(null)}catch(e){j("Failed to load combos. Please try again later."),console.error(e)}finally{i(!1)}}()},[]);let I=async s=>{u(!0),j(null);try{let a=function(e){let s=[],a=[],n=e.split("\n"),l=!1;for(let e of n){if(!(e=e.trim())||e.startsWith("//")||e.startsWith("#"))continue;if(e.toLowerCase().match(/^(commander|commanders):/)){l=!0;continue}e.toLowerCase().match(/^(deck|mainboard|main|creature|instant|sorcery|artifact|enchantment|planeswalker|land|sideboard):/)&&(l=!1);let n=function(e){let s=1,a=e.match(/^(\d+)x?\s+/i);return(a&&(s=parseInt(a[1]),e=e.replace(/^\d+x?\s+/i,"")),(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\[[A-Z0-9]+\]/g,"")).replace(/\([A-Z0-9]+\)\s*\d*/g,"")).replace(/\s+\d+\s*$/,"")).replace(/\*CMDR\*/i,"")).replace(/\(Commander\)/i,"")).replace(/\*F\*/i,"")).replace(/\s+\(Foil\)/i,"")).trim())&&!(e.length<2))?{name:e,quantity:s}:null}(e);if(n){let{name:e,quantity:t}=n;l&&a.push(e);for(let a=0;a<t;a++)s.push(e)}}return{cards:s,commanders:a}}(s);L(a.cards),T(a.deckName||"Your Deck"),console.log("Analyzing ".concat(a.cards.length," cards against ").concat(e.length," combos..."));let{foundCombos:n,almostCombos:l}=function(e,s){let a=e.map(x),n=[],l=[];for(let e of s){let s=e.uses.map(e=>e.card.name),t=[];for(let e of s){let s=x(e);a.includes(s)||t.push(e)}0===t.length?n.push(e):1===t.length&&l.push({combo:e,missingCards:t})}return{foundCombos:n,almostCombos:l}}(a.cards,e);console.log("Found ".concat(n.length," complete combos and ").concat(l.length," almost-combos")),B(n),E(l)}catch(s){let e=s instanceof Error?s.message:"Failed to import decklist";j(e),console.error("Import error:",s),alert("Error: ".concat(e))}finally{u(!1)}},D=F.length>0?A:e,G=(0,l.useMemo)(()=>D.filter(e=>{let s=""===g||e.uses.some(e=>e.card.name.toLowerCase().includes(g.toLowerCase()))||e.description.toLowerCase().includes(g.toLowerCase())||e.produces.some(e=>e.feature.name.toLowerCase().includes(g.toLowerCase())),a=0===b.length||b.every(s=>e.identity.includes(s)),n=0===C.length||C.some(s=>{let a=s.toLowerCase();return e.legalities[a]});return s&&a&&n}),[D,g,b,C]),P=(e,s,a)=>{S({name:e,x:s,y:a})},O=()=>{S(null)};return a?(0,n.jsxs)("div",{className:"app",children:[(0,n.jsx)("header",{className:"header",children:(0,n.jsx)("h1",{children:"⚔️ MTG Combo Finder"})}),(0,n.jsxs)("div",{style:{padding:"2rem",textAlign:"center",color:"#9ca3af"},children:[(0,n.jsx)("p",{children:"Loading combo database from Commander Spellbook..."}),(0,n.jsx)("p",{style:{fontSize:"0.85rem",marginTop:"0.5rem"},children:"This may take a moment..."})]})]}):o?(0,n.jsxs)("div",{className:"app",children:[(0,n.jsx)("header",{className:"header",children:(0,n.jsx)("h1",{children:"⚔️ MTG Combo Finder"})}),(0,n.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"#f59e0b"},children:(0,n.jsx)("p",{children:"Importing your decklist and finding combos..."})})]}):p?(0,n.jsxs)("div",{className:"app",children:[(0,n.jsx)("header",{className:"header",children:(0,n.jsx)("h1",{children:"⚔️ MTG Combo Finder"})}),(0,n.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"#ef4444"},children:(0,n.jsx)("p",{children:p})})]}):(0,n.jsxs)("div",{className:"app",children:[(0,n.jsxs)("header",{className:"header",children:[(0,n.jsx)("h1",{children:"⚔️ MTG Combo Finder"}),F.length>0&&(0,n.jsx)("input",{type:"text",className:"search-bar",placeholder:"Search combos by card name, effect, or keyword...",value:g,onChange:e=>f(e.target.value)})]}),(0,n.jsx)(m,{onImport:I,onClear:()=>{L([]),T(""),B([]),E([])},hasDecklist:F.length>0,deckName:M,comboCount:A.length}),0===F.length?(0,n.jsx)("div",{style:{padding:"2rem",textAlign:"center",color:"#9ca3af"},children:(0,n.jsx)("p",{children:"Import your decklist above to find all available combos in your deck!"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"main-content",children:[(0,n.jsx)(d,{selectedColors:b,selectedFormats:C,onColorToggle:e=>{N(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},onFormatToggle:e=>{y(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])}}),(0,n.jsx)("div",{className:"combo-grid",children:0===G.length?(0,n.jsx)("p",{style:{color:"#9ca3af",gridColumn:"1 / -1"},children:"No combos found matching your criteria."}):G.map(e=>(0,n.jsx)(t,{combo:e,onClick:()=>k(e),onCardHover:P,onCardLeave:O},e.id))})]}),R.length>0&&(0,n.jsxs)("div",{className:"almost-combos-section",children:[(0,n.jsxs)("h3",{children:["⚠️ Almost There! (",R.length," combos missing 1 card)"]}),(0,n.jsx)("p",{children:"Add one of these cards to unlock more combos:"}),(0,n.jsx)("div",{className:"combo-grid",children:R.slice(0,6).map(e=>{let{combo:s,missingCards:a}=e;return(0,n.jsxs)("div",{className:"combo-card",onClick:()=>k(s),children:[(0,n.jsx)("h3",{children:s.uses.map(e=>e.card.name).join(" + ")}),(0,n.jsxs)("p",{style:{color:"#f59e0b",marginTop:"0.5rem"},children:["Missing: ",(0,n.jsx)("span",{className:"missing-card",children:a[0]})]})]},s.id)})})]})]}),v&&(0,n.jsx)(c,{combo:v,onClose:()=>k(null)}),w&&(0,n.jsx)(r,{cardName:w.name,position:{x:w.x,y:w.y}})]})}},9317:(e,s,a)=>{Promise.resolve().then(a.bind(a,5115))}},e=>{e.O(0,[441,255,358],()=>e(e.s=9317)),_N_E=e.O()}]);